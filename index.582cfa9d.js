const e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t=new class{constructor(t=e){console.log(t),this.gameStatus="idle",this.score=0,this.field=t}moveLeft(){for(let e=0;e<this.field.length;e++)for(let t=1;t<this.field[e].length;t++){let i=t;for(;i>0&&0===this.field[e][i-1];)this.field[e][i-1]=this.field[e][i],this.field[e][i]=0,i--;i>0&&this.field[e][i-1]===this.field[e][i]&&(this.score+=2*this.field[e][i-1],this.field[e][i-1]*=2,this.field[e][i]=0)}}moveRight(){for(let e=0;e<this.field.length;e++)for(let t=this.field[e].length-1;t>=0;t--){let i=t;for(;i<this.field[e].length-1&&0===this.field[e][i+1];)this.field[e][i+1]=this.field[e][i],this.field[e][i]=0,i++;i<this.field[e].length-1&&this.field[e][i+1]===this.field[e][i]&&(this.score+=2*this.field[e][i+1],this.field[e][i+1]*=2,this.field[e][i]=0)}}moveUp(){let t=e.length;for(let i=0;i<t;i++){let l=!1;for(let s=1;s<t;s++)if(0!==e[s][i]){let t=s;for(;t>0&&0===e[t-1][i];)e[t-1][i]=e[t][i],e[t][i]=0,t--;!l&&t>0&&e[t-1][i]===e[t][i]&&(e[t-1][i]*=2,e[t][i]=0,l=!0)}}}moveDown(){for(let e=this.field.length-2;e>=0;e--)for(let t=0;t<this.field[e].length;t++){let i=e;for(;i<this.field.length-1&&0===this.field[i+1][t];)this.field[i+1][t]=this.field[i][t],this.field[i][t]=0,i++;i<this.field.length-1&&this.field[i+1][t]===this.field[i][t]&&(this.score+=2*this.field[i+1][t],this.field[i+1][t]*=2,this.field[i][t]=0)}}getScore(){return this.score}getState(){return this.field}getStatus(){return this.gameStatus}start(){this.addingNumberToField(),this.addingNumberToField(),this.gameStatus="playing"}restart(){this.field=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addingNumberToField(),this.addingNumberToField(),n(),this.gameStatus="playing",this.score=0,r()}addingNumberToField(){let e=+Math.floor(4*Math.random()),t=+Math.floor(4*Math.random());this.field[e][t]?this.addingNumberToField():(this.field[e][t]=Math.random()>=.9?4:2,n())}checkVictory(){for(let e=0;e<this.field.length;e++)for(let t=0;t<this.field[e].length;t++)if(2048===this.field[e][t])return this.gameStatus="win",!0;return!1}canMoveCellsRight(){for(let e=0;e<this.field.length;e++)for(let t=this.field[e].length-1;t>=0;t--)if(0===this.field[e][t+1]&&this.field[e][t]!==this.field[e][t+1]||this.field[e][t+1]===this.field[e][t]&&0!==this.field[e][t])return!0;return!1}canMoveCellsLeft(){for(let e=0;e<this.field.length;e++)for(let t=this.field[e].length-1;t>=1;t--)if(0===this.field[e][t-1]&&this.field[e][t]!==this.field[e][t-1]||this.field[e][t-1]===this.field[e][t]&&0!==this.field[e][t])return!0;return!1}canMoveCellsUp(){for(let e=1;e<this.field.length;e++)for(let t=0;t<this.field[e].length;t++)if(0===this.field[e-1][t]&&this.field[e][t]!==this.field[e-1][t]||this.field[e-1][t]===this.field[e][t]&&0!==this.field[e][t])return!0;return!1}canMoveCellsDown(){for(let e=0;e<this.field.length-1;e++)for(let t=0;t<this.field[e].length;t++)if(0===this.field[e+1][t]&&this.field[e][t]!==this.field[e+1][t]||this.field[e+1][t]===this.field[e][t]&&0!==this.field[e][t])return!0;return!1}},i=document.querySelector(".start"),l=document.querySelector(".message-start"),s=document.querySelector(".message-win"),d=document.querySelector(".message-lose"),h=document.querySelector(".game-score"),[...o]=document.getElementsByClassName("field-cell");function r(){for(let e=0;e<o.length;e++)o[e].className="field-cell",t.field.flat()[e]&&o[e].classList.add(`field-cell--${t.field.flat()[e]}`)}function n(){for(let e=0;e<o.length;e++)[...o][e].innerText=t.field.flat()[e]||"";h.innerText=t.score}i.addEventListener("click",()=>{i.classList.contains("start")||(t.restart(),d.classList.add("hidden"),s.classList.add("hidden"),h.innerText=t.score),i.classList.contains("start")&&(t.start(),i.classList.add("restart"),i.classList.remove("start"),i.innerText="Restart",l.classList.add("hidden")),n(),r()}),document.addEventListener("keyup",e=>{switch(e.key){case"ArrowUp":t.canMoveCellsUp()&&(t.checkVictory()||"playing"!==t.gameStatus||(t.moveUp(),t.addingNumberToField(),n(),r()),t.checkVictory()&&s.classList.remove("hidden")),t.canMoveCellsDown()||t.canMoveCellsUp()||t.canMoveCellsRight()||t.canMoveCellsLeft()||(t.gameStatus="lose",d.classList.remove("hidden"));break;case"ArrowLeft":t.canMoveCellsLeft()&&(t.checkVictory()||"playing"!==t.gameStatus||(t.moveLeft(),t.addingNumberToField(),n(),r()),t.checkVictory()&&s.classList.remove("hidden")),t.canMoveCellsDown()||t.canMoveCellsUp()||t.canMoveCellsRight()||t.canMoveCellsLeft()||(t.gameStatus="lose",d.classList.remove("hidden"));break;case"ArrowDown":t.canMoveCellsDown()&&(t.checkVictory()||"playing"!==t.gameStatus||(t.moveDown(),t.addingNumberToField(),n(),r()),t.checkVictory()&&s.classList.remove("hidden")),t.canMoveCellsDown()||t.canMoveCellsUp()||t.canMoveCellsRight()||t.canMoveCellsLeft()||(t.gameStatus="lose",d.classList.remove("hidden"));break;case"ArrowRight":t.canMoveCellsRight()&&(t.checkVictory()||"playing"!==t.gameStatus||(t.moveRight(),t.addingNumberToField(),n(),r()),t.checkVictory()&&s.classList.remove("hidden")),t.canMoveCellsDown()||t.canMoveCellsUp()||t.canMoveCellsRight()||t.canMoveCellsLeft()||(t.gameStatus="lose",d.classList.remove("hidden"))}});
//# sourceMappingURL=index.582cfa9d.js.map
